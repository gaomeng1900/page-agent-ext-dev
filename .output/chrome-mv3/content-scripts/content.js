var content=(function(){"use strict";function p(s){return s}const a=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;async function h(s,t){const e=a.runtime.getURL(s),n=document.createElement("script");a.runtime.getManifest().manifest_version===2?n.innerHTML=await fetch(e).then(r=>r.text()):n.src=e,(document.head??document.documentElement).append(n)}const m={matches:["<all_urls>"],async main(s){console.log("%cðŸ”Œ Page Agent Content Script","color: #00bcd4; font-weight: bold; font-size: 14px"),console.log("%c   Running in isolated world","color: #999; font-size: 12px"),await h("/main-world.js"),console.log("%câœ… Injected main-world script","color: #4caf50; font-weight: bold"),window.addEventListener("message",async t=>{if(t.source!==window||t.data.type!=="PAGE_AGENT_REQUEST")return;const{messageId:e,sessionId:n,action:r,payload:i}=t.data;console.log("%cðŸ“¨ [Content] Forwarding to background","color: #ff9800; font-weight: bold"),console.log(`%c   Action: ${r} | Session: ${n?.substring(0,12)}...`,"color: #999");try{let o;r==="LINK"?o=await chrome.runtime.sendMessage({type:"LINK",sessionId:n,payload:i}):r==="GET_TABS"?o=await chrome.runtime.sendMessage({type:"GET_TABS",sessionId:n}):r==="EXECUTE_SCRIPT"?o=await chrome.runtime.sendMessage({type:"EXECUTE_SCRIPT",sessionId:n,payload:i}):r==="OPEN_TAB"?o=await chrome.runtime.sendMessage({type:"OPEN_TAB",sessionId:n,payload:i}):r==="CLOSE_TAB"?o=await chrome.runtime.sendMessage({type:"CLOSE_TAB",sessionId:n,payload:i}):o={success:!1,error:"Unknown action"},console.log("%cðŸ“¬ [Content] Response from background","color: #4caf50; font-weight: bold"),console.log(`%c   Success: ${o.success}`,"color: #999"),window.postMessage({type:"PAGE_AGENT_RESPONSE",messageId:e,...o},"*")}catch(o){window.postMessage({type:"PAGE_AGENT_RESPONSE",messageId:e,success:!1,error:o instanceof Error?o.message:String(o)},"*")}})}};function c(s,...t){}const w={debug:(...s)=>c(console.debug,...s),log:(...s)=>c(console.log,...s),warn:(...s)=>c(console.warn,...s),error:(...s)=>c(console.error,...s)};class u extends Event{constructor(t,e){super(u.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=e}static EVENT_NAME=g("wxt:locationchange")}function g(s){return`${a?.runtime?.id}:content:${s}`}function E(s){let t,e;return{run(){t==null&&(e=new URL(location.href),t=s.setInterval(()=>{let n=new URL(location.href);n.href!==e.href&&(window.dispatchEvent(new u(n,e)),e=n)},1e3))}}}class l{constructor(t,e){this.contentScriptName=t,this.options=e,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=g("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=E(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return a.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,e){const n=setInterval(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(t,e){const n=setTimeout(()=>{this.isValid&&t()},e);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(t){const e=requestAnimationFrame((...n)=>{this.isValid&&t(...n)});return this.onInvalidated(()=>cancelAnimationFrame(e)),e}requestIdleCallback(t,e){const n=requestIdleCallback((...r)=>{this.signal.aborted||t(...r)},e);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(t,e,n,r){e==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(e.startsWith("wxt:")?g(e):e,n,{...r,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),w.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:l.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){const e=t.data?.type===l.SCRIPT_STARTED_MESSAGE_TYPE,n=t.data?.contentScriptName===this.contentScriptName,r=!this.receivedMessageIds.has(t.data?.messageId);return e&&n&&r}listenForNewerScripts(t){let e=!0;const n=r=>{if(this.verifyScriptStartedEvent(r)){this.receivedMessageIds.add(r.data.messageId);const i=e;if(e=!1,i&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}}function T(){}function d(s,...t){}const f={debug:(...s)=>d(console.debug,...s),log:(...s)=>d(console.log,...s),warn:(...s)=>d(console.warn,...s),error:(...s)=>d(console.error,...s)};return(async()=>{try{const{main:s,...t}=m,e=new l("content",t);return await s(e)}catch(s){throw f.error('The content script "content" crashed on startup!',s),s}})()})();
content;